v {xschem version=3.1.0 file_version=1.2
}
G {}
K {}
V {}
S {}
E {}
N 3220 -2250 3220 -2190 {
lab=Vpixel_out}
N 3220 -2050 3220 -2020 {
lab=#net1}
N 3220 -1960 3220 -1920 {
lab=GND}
N 3120 -1990 3180 -1990 {
lab=Vb0}
N 3120 -2080 3180 -2080 {
lab=Vb1}
N 4280 -2530 4280 -2500 {
lab=Vb0}
N 4280 -2680 4280 -2590 {
lab=Vb1}
N 4280 -2440 4280 -2390 {
lab=GND}
N 4230 -2470 4280 -2470 {
lab=GND}
N 4230 -2470 4230 -2390 {
lab=GND}
N 4230 -2390 4280 -2390 {
lab=GND}
N 4230 -2560 4230 -2470 {
lab=GND}
N 4230 -2560 4280 -2560 {
lab=GND}
N 4320 -2470 4420 -2470 {
lab=Vb0}
N 4320 -2560 4420 -2560 {
lab=Vb1}
N 4280 -2630 4370 -2630 {
lab=Vb1}
N 4370 -2630 4370 -2560 {
lab=Vb1}
N 4280 -2510 4370 -2510 {
lab=Vb0}
N 4370 -2510 4370 -2470 {
lab=Vb0}
N 4280 -2810 4280 -2740 {
lab=VDD}
N 3220 -2210 3320 -2210 {
lab=Vpixel_out}
N 3220 -2130 3220 -2110 {
lab=#net2}
N 3220 -1990 3270 -1990 {
lab=GND}
N 3270 -1990 3270 -1940 {
lab=GND}
N 3220 -1940 3270 -1940 {
lab=GND}
N 3270 -2080 3270 -1990 {
lab=GND}
N 3220 -2080 3270 -2080 {
lab=GND}
N 3320 -2210 3350 -2210 {
lab=Vpixel_out}
N 2840 -2730 2970 -2730 {
lab=Vpixel_out}
N 3220 -2390 3220 -2250 {
lab=Vpixel_out}
N 2770 -2830 2770 -2790 {
lab=VDD}
N 2770 -2590 2770 -2550 {
lab=GND}
N 2610 -2730 2690 -2730 {
lab=Vin_1}
N 2650 -2750 2690 -2750 {
lab=rst_b_clk}
N 2650 -2710 2690 -2710 {
lab=D1}
N 2760 -3130 2760 -3110 {
lab=rst_b_clk}
N 2760 -3140 2760 -3130 {
lab=rst_b_clk}
N 2940 -3010 2940 -2980 {
lab=rst_b}
N 3350 -2170 3350 -2060 {
lab=Vbuff_out}
N 3350 -2060 3600 -2060 {
lab=Vbuff_out}
N 3600 -2190 3600 -2060 {
lab=Vbuff_out}
N 3520 -2190 3600 -2190 {
lab=Vbuff_out}
N 3790 -2190 3790 -2120 {
lab=Vcap}
N 3790 -2120 3900 -2120 {
lab=Vcap}
N 3900 -2190 3900 -2120 {
lab=Vcap}
N 3990 -2290 3990 -2220 {
lab=Vout}
N 3990 -2160 3990 -2090 {
lab=GND}
N 3600 -2190 3640 -2190 {
lab=Vbuff_out}
N 3670 -2190 3670 -2160 {
lab=GND}
N 3840 -2190 3840 -2160 {
lab=GND}
N 3790 -2120 3790 -2080 {
lab=Vcap}
N 3990 -2190 4070 -2190 {
lab=VDD}
N 2980 -3130 2980 -3110 {
lab=sh_clk}
N 2980 -3140 2980 -3130 {
lab=sh_clk}
N 3670 -2260 3670 -2230 {
lab=sh_clk}
N 3540 -2390 3570 -2390 {
lab=sh_clk}
N 3730 -2390 3760 -2390 {
lab=sh_clk_b}
N 3840 -2260 3840 -2230 {
lab=sh_clk_b}
N 3700 -2190 3790 -2190 {
lab=Vcap}
N 3900 -2190 3950 -2190 {
lab=Vcap}
N 3790 -2190 3810 -2190 {
lab=Vcap}
N 3870 -2190 3900 -2190 {
lab=Vcap}
N 4420 -2560 4470 -2560 {
lab=Vb1}
N 4420 -2470 4470 -2470 {
lab=Vb0}
N 4510 -2440 4510 -2390 {
lab=GND}
N 4280 -2390 4510 -2390 {
lab=GND}
N 4510 -2470 4550 -2470 {
lab=GND}
N 4550 -2470 4550 -2390 {
lab=GND}
N 4510 -2390 4550 -2390 {
lab=GND}
N 4550 -2560 4550 -2470 {
lab=GND}
N 4510 -2560 4550 -2560 {
lab=GND}
N 4510 -2740 4510 -2590 {
lab=Vb2}
N 4280 -2810 4510 -2810 {
lab=VDD}
N 4510 -2810 4510 -2800 {
lab=VDD}
N 4510 -2680 4610 -2680 {
lab=Vb2}
N 4610 -2770 4610 -2680 {
lab=Vb2}
N 4550 -2770 4610 -2770 {
lab=Vb2}
N 3910 -2380 3950 -2380 {
lab=Vb2}
N 3990 -2380 4030 -2380 {
lab=VDD}
N 4030 -2410 4030 -2380 {
lab=VDD}
N 3990 -2410 4030 -2410 {
lab=VDD}
N 4510 -2530 4510 -2500 {
lab=#net3}
N 4470 -2770 4510 -2770 {
lab=VDD}
N 4470 -2810 4470 -2770 {
lab=VDD}
N 2840 -2400 2970 -2400 {
lab=Vpixel_out}
N 2770 -2500 2770 -2460 {
lab=VDD}
N 2770 -2260 2770 -2220 {
lab=GND}
N 2610 -2400 2690 -2400 {
lab=Vin_2}
N 2650 -2420 2690 -2420 {
lab=rst_b_clk}
N 2650 -2380 2690 -2380 {
lab=D2}
N 2840 -2070 2970 -2070 {
lab=Vpixel_out}
N 2770 -2170 2770 -2130 {
lab=VDD}
N 2770 -1930 2770 -1890 {
lab=GND}
N 2610 -2070 2690 -2070 {
lab=Vin_3}
N 2650 -2090 2690 -2090 {
lab=rst_b_clk}
N 2650 -2050 2690 -2050 {
lab=D3}
N 2460 -2740 2460 -2730 {
lab=Vin_1}
N 2460 -2730 2610 -2730 {
lab=Vin_1}
N 2460 -2430 2460 -2400 {
lab=Vin_2}
N 2460 -2400 2610 -2400 {
lab=Vin_2}
N 2460 -2100 2460 -2070 {
lab=Vin_3}
N 2460 -2070 2610 -2070 {
lab=Vin_3}
N 2970 -2400 3220 -2400 {
lab=Vpixel_out}
N 2970 -2070 3040 -2070 {
lab=Vpixel_out}
N 3040 -2400 3040 -2070 {
lab=Vpixel_out}
N 3040 -2730 3040 -2400 {
lab=Vpixel_out}
N 2970 -2730 3040 -2730 {
lab=Vpixel_out}
N 3220 -2400 3220 -2390 {
lab=Vpixel_out}
N 3270 -2700 3330 -2700 {
lab=A}
N 3270 -2640 3330 -2640 {
lab=B}
N 3250 -2990 3250 -2970 {
lab=B}
N 3250 -3000 3250 -2990 {
lab=B}
N 3250 -3130 3250 -3110 {
lab=A}
N 3250 -3140 3250 -3130 {
lab=A}
C {sky130_fd_pr/nfet_01v8_lvt.sym} 3200 -2080 0 0 {name=M4
L=0.5
W=5
nf=2
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8_lvt.sym} 3200 -1990 0 0 {name=M5
L=0.5
W=5
nf=2
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8_lvt
spiceprefix=X
}
C {gnd.sym} 3220 -1920 0 0 {name=l1 lab=GND}
C {sky130_fd_pr/nfet_01v8_lvt.sym} 4300 -2560 0 1 {name=M6
L=0.5
W=5
nf=2
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8_lvt.sym} 4300 -2470 0 1 {name=M1
L=0.5
W=5
nf=2
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8_lvt
spiceprefix=X
}
C {gnd.sym} 4280 -2390 0 0 {name=l1 lab=GND}
C {isource.sym} 4280 -2710 0 0 {name=I1 value=5u}
C {lab_wire.sym} 4280 -2790 0 0 {name=l1 sig_type=std_logic lab=VDD}
C {lab_wire.sym} 4420 -2560 0 0 {name=l1 sig_type=std_logic lab=Vb1}
C {lab_wire.sym} 4420 -2470 0 0 {name=l1 sig_type=std_logic lab=Vb0}
C {lab_wire.sym} 3130 -2080 0 0 {name=l1 sig_type=std_logic lab=Vb1}
C {lab_wire.sym} 3130 -1990 0 0 {name=l2 sig_type=std_logic lab=Vb0}
C {devices/vsource.sym} 2850 -2950 0 0 {name=V1 net_name=true 
*value="'VDD' pwl 0us 0 1us 'VDD'"
value=1.8}
C {devices/vdd.sym} 2850 -2980 0 0 {name=l9 lab=VDD}
C {devices/gnd.sym} 2850 -2920 0 0 {name=l22 lab=GND}
C {devices/code.sym} 2040 -3150 0 0 {name=TT_MODELS
only_toplevel=true
format="tcleval( @value )"
value="
** opencircuitdesign pdks install
.lib $::SKYWATER_MODELS/sky130.lib.spice tt

"
spice_ignore=false}
C {devices/code_shown.sym} 2190 -3150 0 0 {name=s2 only_toplevel=false value="
*.dc Vdd 0 2 0.1
.option temp=37
.control
save all
run
tran 0.1n 70u
display

plot Vin_1 Vin_2 Vin_3
plot Vpixel_out Vbuff_out
plot rst_b_clk sh_clk Vbuff_out Vcap Vout
*plot rst_b_clk sh_clk
*plot sh_clk sh_clk_b
plot Vcap Vout
plot vm1#branch
plot vm2#branch
*plot vm3#branch

.endc
"}
C {devices/ammeter.sym} 3220 -2160 0 0 {name=Vm1 current=40e-6}
C {devices/vsource.sym} 2940 -2950 0 0 {name=V2 net_name=true value="0 pulse(1.8V 0V 10us 0us 0us 5us)"}
C {devices/gnd.sym} 2940 -2920 0 0 {name=l12 lab=GND}
C {devices/lab_pin.sym} 2940 -2980 0 0 {name=l23 lab=rst_b}
C {cmos_imager/3T.sym} 2650 -2710 0 0 {name=X1}
C {lab_wire.sym} 2770 -2820 0 0 {name=l1 sig_type=std_logic lab=VDD}
C {gnd.sym} 2770 -2550 0 0 {name=l1 lab=GND}
C {devices/lab_pin.sym} 2670 -2750 0 0 {name=l23 lab=rst_b_clk}
C {devices/vsource.sym} 2760 -3080 0 0 {name=V3 value="pulse 0 1.8 0 0.1u 0.1u 25u 30u"}
C {devices/gnd.sym} 2760 -3050 0 0 {name=l12 lab=GND}
C {devices/lab_pin.sym} 2760 -3130 0 1 {name=l23 lab=rst_b_clk}
C {noconn.sym} 2760 -3140 0 0 {name=l2}
C {noconn.sym} 2940 -3010 0 0 {name=l1}
C {ip_block/opamp/miller_2stage/miller_2stage.sym} 3450 -2190 0 0 {name=x2}
C {gnd.sym} 3450 -2130 0 0 {name=l3 lab=GND}
C {devices/vdd.sym} 3450 -2270 0 0 {name=l9 lab=VDD}
C {devices/vsource.sym} 2760 -2950 0 0 {name=V4 value=0.7}
C {lab_wire.sym} 2760 -2980 0 0 {name=l5 sig_type=std_logic lab=Vbias
}
C {devices/gnd.sym} 2760 -2920 0 1 {name=l3 lab=GND}
C {lab_wire.sym} 3420 -2270 0 0 {name=l5 sig_type=std_logic lab=Vbias
}
C {lab_wire.sym} 3580 -2190 0 0 {name=l3 sig_type=std_logic lab=Vbuff_out}
C {lab_wire.sym} 3290 -2210 0 0 {name=l3 sig_type=std_logic lab=Vpixel_out}
C {sky130_fd_pr/nfet_01v8_lvt.sym} 3670 -2210 3 1 {name=M8
L=0.5
W=5
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8_lvt.sym} 3840 -2210 3 1 {name=M14
L=0.5
W=1
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8_lvt
spiceprefix=X
}
C {lab_wire.sym} 3990 -2240 0 0 {name=l3 sig_type=std_logic lab=Vout}
C {devices/vdd.sym} 3990 -2410 0 0 {name=l9 lab=VDD}
C {lab_wire.sym} 3670 -2160 3 0 {name=l3 sig_type=std_logic lab=GND}
C {lab_wire.sym} 3840 -2160 3 0 {name=l3 sig_type=std_logic lab=GND}
C {gnd.sym} 3990 -2090 0 0 {name=l3 lab=GND}
C {sky130_fd_pr/cap_mim_m3_1.sym} 3790 -2050 0 0 {name=C2 model=cap_mim_m3_1 W=20 L=20 MF=1 spiceprefix=X}
C {gnd.sym} 3790 -2020 0 0 {name=l3 lab=GND}
C {lab_wire.sym} 4060 -2190 0 1 {name=l3 sig_type=std_logic lab=VDD}
C {devices/vsource.sym} 2980 -3080 0 0 {name=V5 value="pulse 0 1.8 5u 0.1u 0.1u 5u 20u"}
C {devices/gnd.sym} 2980 -3050 0 0 {name=l12 lab=GND}
C {devices/lab_pin.sym} 2980 -3130 0 1 {name=l23 lab=sh_clk}
C {noconn.sym} 2980 -3140 0 0 {name=l3}
C {devices/lab_pin.sym} 3670 -2260 0 1 {name=l23 lab=sh_clk}
C {ip_block/logic_gate/inv.sym} 810 910 0 0 {name=X3}
C {devices/lab_pin.sym} 3540 -2390 0 0 {name=l23 lab=sh_clk}
C {devices/lab_pin.sym} 3760 -2390 0 1 {name=l23 lab=sh_clk_b}
C {devices/lab_pin.sym} 3840 -2260 0 1 {name=l23 lab=sh_clk_b}
C {devices/vdd.sym} 3640 -2450 0 0 {name=l9 lab=VDD}
C {devices/gnd.sym} 3640 -2330 0 0 {name=l12 lab=GND}
C {lab_wire.sym} 3790 -2140 0 0 {name=l4 sig_type=std_logic lab=Vcap}
C {sky130_fd_pr/pfet_01v8_lvt.sym} 3970 -2190 0 0 {name=M15
L=0.5
W=8
nf=1
mult=20
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8_lvt.sym} 4490 -2560 0 0 {name=M16
L=0.5
W=5
nf=2
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8_lvt.sym} 4490 -2470 0 0 {name=M17
L=0.5
W=5
nf=2
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8_lvt.sym} 4530 -2770 0 1 {name=M18
L=2
W=16
nf=1
mult=8
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8_lvt
spiceprefix=X
}
C {lab_wire.sym} 4610 -2680 0 1 {name=l4 sig_type=std_logic lab=Vb2}
C {sky130_fd_pr/pfet_01v8_lvt.sym} 3970 -2380 0 0 {name=M19
L=2
W=16
nf=1
mult=8
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8_lvt
spiceprefix=X
}
C {lab_wire.sym} 3910 -2380 0 0 {name=l4 sig_type=std_logic lab=Vb2}
C {devices/ammeter.sym} 3990 -2320 0 0 {name=Vm2 current=40e-6}
C {cmos_imager/3T.sym} 2650 -2380 0 0 {name=X4}
C {lab_wire.sym} 2770 -2490 0 0 {name=l4 sig_type=std_logic lab=VDD}
C {gnd.sym} 2770 -2220 0 0 {name=l5 lab=GND}
C {devices/lab_pin.sym} 2670 -2420 0 0 {name=l23 lab=rst_b_clk}
C {cmos_imager/3T.sym} 2650 -2050 0 0 {name=X5}
C {lab_wire.sym} 2770 -2160 0 0 {name=l4 sig_type=std_logic lab=VDD}
C {gnd.sym} 2770 -1890 0 0 {name=l5 lab=GND}
C {devices/lab_pin.sym} 2670 -2090 0 0 {name=l23 lab=rst_b_clk}
C {cmos_imager/photodiode_real_rc_10p.sym} -460 630 0 0 {name=X6}
C {gnd.sym} 2320 -2610 0 0 {name=l4 lab=GND}
C {cmos_imager/photodiode_real_rc_20p.sym} -460 940 0 0 {name=X7}
C {cmos_imager/photodiode_real_rc_40p.sym} -460 1270 0 0 {name=X8}
C {gnd.sym} 2320 -2300 0 0 {name=l4 lab=GND}
C {gnd.sym} 2320 -1970 0 0 {name=l4 lab=GND}
C {lab_wire.sym} 2530 -2730 0 0 {name=l4 sig_type=std_logic lab=Vin_1}
C {lab_wire.sym} 2530 -2400 0 0 {name=l4 sig_type=std_logic lab=Vin_2}
C {lab_wire.sym} 2520 -2070 0 0 {name=l4 sig_type=std_logic lab=Vin_3}
C {ip_block/logic_gate/2_to_4_decoder.sym} 580 590 0 0 {name=X9}
C {devices/gnd.sym} 3430 -2550 0 0 {name=l12 lab=GND}
C {devices/vdd.sym} 3430 -2760 0 0 {name=l9 lab=VDD}
C {lab_wire.sym} 2650 -2710 0 0 {name=l4 sig_type=std_logic lab=D1}
C {lab_wire.sym} 2650 -2380 0 0 {name=l4 sig_type=std_logic lab=D2}
C {lab_wire.sym} 2650 -2050 0 0 {name=l4 sig_type=std_logic lab=D3}
C {lab_wire.sym} 3530 -2680 0 1 {name=l4 sig_type=std_logic lab=D1}
C {lab_wire.sym} 3530 -2660 0 1 {name=l4 sig_type=std_logic lab=D2}
C {lab_wire.sym} 3530 -2640 0 1 {name=l4 sig_type=std_logic lab=D3}
C {noconn.sym} 3530 -2700 0 1 {name=l4}
C {devices/lab_pin.sym} 3270 -2700 0 0 {name=l7 lab=A}
C {devices/lab_pin.sym} 3270 -2640 0 0 {name=l23 lab=B}
C {devices/vsource.sym} 3250 -2940 0 0 {name=V6 value="pulse 0 1.8 5u 0.25u 0.25u 5u 10u"}
C {devices/gnd.sym} 3250 -2910 0 0 {name=l12 lab=GND}
C {devices/lab_pin.sym} 3250 -2990 0 1 {name=l23 lab=B}
C {noconn.sym} 3250 -3000 0 0 {name=l5}
C {devices/vsource.sym} 3250 -3080 0 0 {name=V7 value="pulse 0 1.8 2.5u 0.05u 0.05u 2.5u 5u"}
C {devices/gnd.sym} 3250 -3050 0 0 {name=l6 lab=GND}
C {devices/lab_pin.sym} 3250 -3130 0 1 {name=l7 lab=A}
C {noconn.sym} 3250 -3140 0 0 {name=l8}
